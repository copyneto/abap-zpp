sap.ui.define(["sap/ui/export/Spreadsheet","sap/ui/core/util/Export","sap/ui/export/library"],function(e,t,s,r){"use strict";var a=s.EdmType;return sap.ui.controller("br.com.trescoracoes.zppplanoproducao.ext.controller.ListReportExt",{_createColumnConfig+
Curto:function(){var e=[];e.push({property:"Tipo de Ordem",type:a.String});e.push({property:"Produto",type:a.String});e.push({property:"Fábrica",type:a.String});e.push({property:"Centro de Planejamento",type:a.String});e.push({property:"Quantidade",type:+
a.String});e.push({property:"Data",type:a.String});e.push({property:"Código de fixação",type:a.String});e.push({property:"Versão",type:a.String});return e},_createColumnConfigMedio:function(){var e=[];e.push({property:"Produto",type:a.String});e.push({pr+
operty:"Fábrica",type:a.String});e.push({property:"Versão",type:a.String});e.push({property:"Ativo",type:a.String});e.push({property:"Período",type:a.String});e.push({property:"Data",type:a.String});e.push({property:"Quantidade",type:a.String});e.push({p+
roperty:"UM",type:a.String});e.push({property:"Nº de série",type:a.String});e.push({property:"Versão de Produção",type:a.String});return e},_downloadTemplate:function(t,s){var r,a;if(t){r=this._createColumnConfigCurto();a="CARGA_PLAN_SEMANAL.xlsx"}else{r+
=this._createColumnConfigMedio();a="CARGA_PLAN_MENSAL.xlsx"}var o={workbook:{columns:r},dataSource:[""],count:1,fileName:a};var n=new e(o);n.build().finally(function(){n.destroy()})},onBaixarLayout:function(e){var t=new sap.m.Dialog({contentWidth:"300px"+
,resizable:true,type:"Message"});t.setTitle("Baixar Layout Excel");var s=new sap.ui.layout.VerticalLayout({width:"100%",content:[new sap.m.Text({text:" "}),new sap.m.RadioButtonGroup({id:"rbg2",columns:2,buttons:[new sap.m.RadioButton({id:"curto",text:"C+
urto Prazo"}),new sap.m.RadioButton({id:"medio",text:"Médio Prazo"})]})]});var r=new sap.m.Button({text:"Baixar",type:"Accept",press:function(e){this._downloadTemplate(sap.ui.getCore().getElementById("curto").getSelected(),sap.ui.getCore().getElementById+
("medio").getSelected());t.close();t.destroy()}.bind(this)});var a=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){t.close();t.destroy();this.getView().removeAllDependents()}.bind(this)});t.addContent(s);t.setBeginButton(a);t.setEndButto+
n(r);t.open()},onUploadExcel:function(e){var t=new sap.m.Dialog({contentWidth:"300px",resizable:true,type:"Message"});t.setTitle("Carregar arquivo Excel");var s="/sap/opu/odata/sap/ZPP_PLANO_PRODUCAO_SRV_EX/";var r=new sap.ui.model.odata.ODataModel(s,fal+
se);var a=s+"excelSet";var o=new sap.ui.unified.FileUploader({width:"100%",fileType:"xlsx",style:"Emphasized",uploadComplete:function(e){var s=this.oView.sId+"--responsiveTable";var r=this.byId(s);r.getModel().refresh(true);t.close();t.destroy();if(e.mPa+
rameters.status=="200"||e.mParameters.status=="201"){sap.m.MessageToast.show("Carga realizada com sucesso.")}else{let t=[];for(const s of e.mParameters.responseRaw.matchAll(/(?:<message>(.*?)<[/]message>)/gm)){t.push(s[1])}let s=[];for(const t of e.mPara+
meters.responseRaw.matchAll(/(?:<severity>(.*?)<[/]severity>)/gm)){switch(t[1]){case"error":s.push(sap.ui.core.MessageType.Error);break;case"info":s.push(sap.ui.core.MessageType.Information);break;case"success":s.push(sap.ui.core.MessageType.Success);bre+
ak;case"warning":s.push(sap.ui.core.MessageType.Warning);break;default:s.push(sap.ui.core.MessageType.None);break}}for(let e=0;e<t.length;e++){if(t[e]=="Ocorreu uma exceção"){continue}sap.ui.getCore().getMessageManager().addMessages(new sap.ui.core.messa+
ge.Message({message:t[e],persistent:true,type:s[e]}));alert(t[e])}}}.bind(this)});o.setName("Simple Uploader");o.setUploadUrl(a);o.setSendXHR(true);o.setUseMultipart(false);o.setUploadOnChange(false);var n=new sap.ui.unified.FileUploaderParameter({name:"+
x-csrf-token",value:r.getSecurityToken()});o.insertHeaderParameter(n);var i=new sap.m.Button({text:"Upload",type:"Accept",press:function(){var e=o.getFocusDomRef();var t=e.files[0];if(o.getValue()===""){sap.m.MessageToast.show("Favor selecionar um arquiv+
o");return}var s=new sap.ui.unified.FileUploaderParameter({name:"Content-Type",value:t.type});o.insertHeaderParameter(s);var r=u.getSelectedButton().mProperties.text[0];o.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:o+
.getValue()+";"+r}));o.upload()}.bind(this)});var p=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){t.close();t.destroy();this.getView().removeAllDependents()}.bind(this)});var u=new sap.m.RadioButtonGroup({columns:2,width:"100%",buttons+
:[new sap.m.RadioButton({text:"Curto Prazo"}),new sap.m.RadioButton({text:"Médio Prazo"})]});t.addContent(o);t.addContent(u);t.setBeginButton(p);t.setEndButton(i);t.open()},onActionDownload:function(e){let t=this.templateBaseExtension.getExtensionAPI().g+
etSelectedContexts();if(!t.length){sap.m.MessageToast.show("Nenhum registro selecionado.");return}if(t.length>1){alert("Favor selecionar apenas um registro");return}var s="/sap/opu/odata/sap/ZPP_PLANO_PRODUCAO_SRV_EX/";var r=new sap.ui.model.odata.ODataM+
odel(s,false);var a="downloadSet(Id='"+t[0].getObject().Id+"')/$value";var o=function(){return new Promise(function(e,t){r.read(a,{success:function(t,s){e();sap.m.URLHelper.redirect(s.requestUri,true)}.bind(this),error:function(e){t();let s=[];for(const +
t of e.response.body.matchAll(/(?:<message>(.*?)<[/]message>)/gm)){s.push(t[1])}let r=[];for(const t of e.response.body.matchAll(/(?:<severity>(.*?)<[/]severity>)/gm)){switch(t[1]){case"error":r.push(sap.ui.core.MessageType.Error);break;case"info":r.push+
(sap.ui.core.MessageType.Information);break;case"success":r.push(sap.ui.core.MessageType.Success);break;case"warning":r.push(sap.ui.core.MessageType.Warning);break;default:r.push(sap.ui.core.MessageType.None);break}}for(let e=0;e<s.length;e++){if(s[e]=="+
Ocorreu uma exceção"){continue}sap.ui.getCore().getMessageManager().addMessages(new sap.ui.core.message.Message({message:s[e],persistent:true,type:r[e]}))}}.bind(this)})}.bind(this))}.bind(this);this.extensionAPI.securedExecution(o,{busy:{set:true,check:+
false},sActionLabel:"Mensagens"})},showSuccessMessage:function(e){this.getView().setBusy(false)},showErrorMessage:function(e){this.getView().setBusy(false)}})});                                                                                              